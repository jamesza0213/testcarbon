<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Carbon Dashboard</title>

<style>
body{
font-family:system-ui;
max-width:800px;
margin:auto;
padding:20px;
text-align:center;
}
.card{
background:#f5f5f5;
padding:30px;
border-radius:12px;
margin-top:20px;
}
.big{
font-size:48px;
color:green;
}
</style>
</head>

<body>

<h1>üå± Carbon Reduction Dashboard</h1>

<div class="card">
<h3>‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô</h3>
<div class="big" id="total">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
</div>

<script>

const sheetURL = "PASTE_CSV_LINK_HERE";

async function loadData(){

try{
const res = await fetch(sheetURL);
const text = await res.text();

const rows = text.trim().split("\n").slice(1);

let total = 0;

rows.forEach(row=>{
const cols = row.split(",");
const value = Number(cols[1]);
if(!isNaN(value)) total += value;
});

document.getElementById("total").textContent =
total.toFixed(1)+" kg CO‚ÇÇ";

}catch{
document.getElementById("total").textContent="‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ";
}

}

loadData();

// refresh ‡∏ó‡∏∏‡∏Å 1 ‡∏ô‡∏≤‡∏ó‡∏µ
setInterval(loadData,60000);

</script>

</body>
</html>
